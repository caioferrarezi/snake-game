(()=>{"use strict";var t={LEFT:[37,65],UP:[38,87],RIGHT:[39,68],DOWN:[40,83],ACTION:[13,32]};function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}const i=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._screen,this._context,this._pixelSize}var i,n;return i=t,(n=[{key:"create",value:function(t,e){this._screen=document.createElement("canvas"),this._screen.width=t,this._screen.height=e,this._pixelSize=10*Math.ceil(t/e),this._context=this._screen.getContext("2d"),document.body.insertAdjacentElement("afterbegin",this._screen)}},{key:"getRandomPosition",value:function(){var t=Math.floor(Math.random()*this.width),e=Math.floor(Math.random()*this.height);return{x:t-t%this._pixelSize,y:e-e%this._pixelSize}}},{key:"width",get:function(){return this._screen.width}},{key:"height",get:function(){return this._screen.height}},{key:"pixelSize",get:function(){return this._pixelSize}},{key:"context",get:function(){return this._context}}])&&e(i.prototype,n),t}());function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function t(e,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;n(this,t),this.x=e,this.y=i,this.prev=s,this.next=o};function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._pos=i.getRandomPosition(),this._vel={x:0,y:0},this._size=i.pixelSize,this._color="#070600",this._init()}var e,n;return e=t,(n=[{key:"_init",value:function(){var t=this._pos,e=t.x,i=t.y;this._head=null,this._tail=null,this._push(e,i)}},{key:"_push",value:function(t,e){if(!this._head)return this._head=new s(t,e),void(this._tail=this._head);var i=new s(t,e,this._tail,null);this._tail.next=i,this._tail=i}},{key:"_add",value:function(t,e){if(!this._head)return this._head=new s(t,e),void(this._tail=this._head);var i=new s(t,e,null,this._head);this._head.prev=i,this._head=i}},{key:"_pop",value:function(){this._tail=this._tail.prev,this._tail.next=null}},{key:"moveLeft",value:function(){this._vel.x!==this._size&&(this._vel={x:-this._size,y:0})}},{key:"moveUp",value:function(){this._vel.y!==this._size&&(this._vel={x:0,y:-this._size})}},{key:"moveRight",value:function(){this._vel.x!==-this._size&&(this._vel={x:this._size,y:0})}},{key:"moveDown",value:function(){this._vel.y!==-this._size&&(this._vel={x:0,y:this._size})}},{key:"is",value:function(t,e){for(var i=this._head.next;null!==i&&null!==i.next;i=i.next)if(i.x===t&&i.y===e)return!0;return!1}},{key:"bitten",value:function(){var t=this._head,e=t.x,i=t.y;return this.is(e,i)}},{key:"hitWall",value:function(){var t=this._head,e=t.x,n=t.y;return e<0||n<0||e>i.width-i.pixelSize||n>i.height-i.pixelSize}},{key:"eat",value:function(t){var e=this._head,i=e.x,n=e.y;return i===t.x&&n===t.y}},{key:"grow",value:function(){for(var t=this._tail,e=0;e<5;e++)this._push(t.x,t.y)}},{key:"update",value:function(){this._pos.x+=this._vel.x,this._pos.y+=this._vel.y,this._add(this._pos.x,this._pos.y),this._pop()}},{key:"show",value:function(){for(var t=this._head;null!==t;t=t.next)i.context.fillStyle=this._color,i.context.fillRect(t.x,t.y,this._size,this._size)}}])&&o(e.prototype,n),t}();function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._size=i.pixelSize,this._color="#EA526F",this._pos=i.getRandomPosition()}var e,n;return e=t,(n=[{key:"update",value:function(){this._pos=i.getRandomPosition()}},{key:"show",value:function(){i.context.fillStyle=this._color,i.context.fillRect(this._pos.x,this._pos.y,this._size,this._size)}},{key:"x",get:function(){return this._pos.x}},{key:"y",get:function(){return this._pos.y}}])&&r(e.prototype,n),t}();function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"show",value:function(t){var e=i.width/2,n=i.height/2;i.context.fillStyle="#222222",i.context.textAlign="center",i.context.textBaseline="middle",i.context.font="normal 48px VT323, monospace",i.context.fillText("You've scored: ".concat(t),e,n-30),i.context.font="normal 32px VT323, monospace",i.context.fillText("Press [Enter] or [Space] to restart",e,n+30)}}])&&l(e.prototype,n),t}();function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var _=new(function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i.create(800,600),this._init()}var n,s;return n=e,(s=[{key:"_init",value:function(){this._state="playing",this._score=0,this._snake=new a,this._fruit=new h,this._gameOverScreen=new u,this._setControls()}},{key:"_clear",value:function(){i.context.fillStyle="#F7F7FF",i.context.fillRect(0,0,i.width,i.height)}},{key:"_showScore",value:function(){i.context.fillStyle="#222222",i.context.textAlign="left",i.context.textBaseline="top",i.context.font="32px VT323, monospace",i.context.fillText("Score: ".concat(this._score),i.pixelSize,i.pixelSize)}},{key:"_setControls",value:function(){window.onkeydown=this._onKeyDown.bind(this)}},{key:"_onKeyDown",value:function(e){var i=e.keyCode;if(e.preventDefault,t.LEFT.includes(i))return this._snake.moveLeft();if(t.UP.includes(i))return this._snake.moveUp();if(t.RIGHT.includes(i))return this._snake.moveRight();if(t.DOWN.includes(i))return this._snake.moveDown();if(t.ACTION.includes(i)){if(!1===this._gameOver)return;this._init()}}},{key:"update",value:function(){if("playing"===this._state&&(this._snake.update(),(this._snake.hitWall()||this._snake.bitten())&&(this._state="game-over"),this._snake.eat(this._fruit))){for(this._snake.grow(),this._fruit.update();this._snake.is(this._fruit.x,this._fruit.y);)this._fruit.update();this._score++}}},{key:"show",value:function(){this._clear(),"game-over"!==this._state?(this._showScore(),this._snake.show(),this._fruit.show()):this._gameOverScreen.show(this._score)}}])&&c(n.prototype,s),e}()),f=Date.now(),v=Date.now();!function t(){(v=Date.now())-f>100&&(f=v,_.update(),_.show()),requestAnimationFrame(t)}()})();
//# sourceMappingURL=main-550413e667a2ccf1d7f7.js.map